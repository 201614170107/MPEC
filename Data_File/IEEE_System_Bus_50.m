%One area 40 bust test system

% A matrix to indicate which nodes are connected to each other.
%         line nmuer   node  node     rectance
Thematrix=[1           1       2      0.06           130 0.9783 0.0217
2 1 3 0.19 130 0.9841 0.0159
3 2 4 0.17 65 0.9532 0.0468
4 3 4 0.04 130 0.9172 0.0828
5 2 5 0.20 130 0.9786 0.0214
6 2 6 0.18 65 0.9497 0.0503
7 4 6 0.04 90 0.9828 0.0172
8 5 7 0.12 70 0.9760 0.0240
9 6 7 0.08 130 0.9211 0.0789
10 6 8 0.04 32 0.9494 0.0506
11 6 9 0.21 65 0.9494 0.0506
12 6 10 0.56 32 0.9211 0.0789
13 9 11 0.21 65 0.9535 0.0465
14 9 10 0.11 65 0.9509 0.0491
15 4 12 0.26 65 0.9660 0.0340
16 12 13 0.14 65 0.9838 0.0162
17 12 14 0.26 32 0.9754 0.0246
18 12 15 0.13 32 0.9598 0.0402
19 12 16 0.20 32 0.9510 0.0490
20 14 15 0.20 16 0.9494 0.0506
21 16 17 0.19 16 0.9494 0.0506
22 15 18 0.22 16 0.9236 0.0764
23 18 19 0.13 16 0.9514 0.0486
24 19 20 0.07 32 0.9509 0.0491
25 10 20 0.21 32 0.9666 0.0334
26 10 17 0.08 32 0.9824 0.0176
27 10 21 0.07 32 0.9786 0.0214
28 10 22 0.15 32 0.9612 0.0388
29 21 22 0.02 32 0.9462 0.0538
30 15 23 0.20 16 0.9498 0.0502
31 22 24 0.18 16 0.9506 0.0494
32 23 24 0.27 16 0.9181 0.0819
33 24 25 0.33 16 0.9483 0.0517
34 25 26 0.38 16 0.9537 0.0463
35 25 27 0.21 16 0.9733 0.0267
36 27 28 0.40 65 0.9818 0.0182
37 27 29 0.42 16 0.9808 0.0192
38 27 30 0.60 16 0.9564 0.0436
39 29 30 0.45 16 0.9537 0.0463
40 8 28 0.20 32 0.9537 0.0463
41 6 28 0.06 32 0.9536 0.0464
42 15 31  .2  17    0.9537 0.0463
43  27 33  .09 17  0.9537 0.0463
44  31 34  .4  17 0.9537 0.0463
45  31 35  0.3  17 0.9537 0.0463
46  10 32  0.21  17  0.9537 0.0463
47  30 31  .3 17 1 .03
48  31 36  .2 17 1 .03
49  13 34  .4 17 1 .03
50  33 37  .33 17 1 .03
51  33 38  .08 17 1 .03
52  29 38  .15 17 1 .03
53  29 39  .38 17 1 .04
54  6 40   .07 17 1 .03
55 8 42     .17 17 1 .03
56 28 41     .27 17 1 .03
57 41 50      .9 17 1 .03
58 41 46     .1 17 1 .03
59 41 49  .14 17 1 .03
60 44 45  .12 17 1 .03
61 45 46  .17 17 1 .03
62 45 47   .27 17 1 .03
63 45 48   .3 17 1 .03
64 45 49   .17 17 1 .03
65 42 45   .14 17 1 .03
66 42 43    .19 17 1 .03
];
%%%%
%hourly energy bid matrix for 24 hoours, the first coloumn shows the busses
%gerators connected to.
heb=[1 1.9 1.4 1.9 2.6 1.6 1.0 1.9 1.6 2.2 2.1 1.8 1.9 1.8 0.8 1.3 2.1 1.9 2.3 2.2 1.8 2.4 1.4 2.2 1.0
5 1.4 1.4 1.3 1.4 1.8 2.1 2.2 2.2 2.1 1.9 1.1 1.6 1.3 2.1 1.7 1.4 1.3 2.2 2.4 1.3 2.2 2.1 1.9 1.3
8 1.0 0.8 1.3 1.9 1.4 1.0 2.1 2.2 1.4 1.0 1.6 1.8 1.8 1.9 2.1 2.3 1.4 2.2 1.9 2.3 1.6 2.2 2.4 2.2
13 2.2 1.6 2.2 1.1 2.4 2.6 1.7 2.2 1.1 1.1 2.1 2.1 2.4 1.1 2.3 1.8 1.7 1.8 1.9 1.1 1.8 1.9 2.1 1.1
21 1.3 2.1 2.1 1.8 1.4 1.1 1.4 1.4 1.6 1.4 1.9 1.6 1.9 1.3 1.0 0.9 2.2 1.4 1.7 2.6 2.1 2.1 1.1 1.9
23 1.8 1.4 1.1 1.0 1.3 1.4 1.3 1.8 1.4 1.3 1.4 1.4 1.4 2.6 1.4 1.9 1.9 2.0 1.8 1.4 2.1 1.6 1.7 1.6
27 1.9 1.6 1.6 2.4 2.2 1.9 2.7 1.3 2.2 2.1 1.3 2.2 1.3 1.7 1.9 2.1 2.1 1.8 1.4 2.4 1.4 1.9 1.3 1.0
28 1.1 1.8 1.8 1.4 1.3 1.6 1.3 1.3 1.5 2.2 2.6 1.8 1.1 1.4 1.1 1.6 1.7 1.6 2.2 1.7 1.9 1.1 1.6 1.8
35 .4  .6  .8  .5  .3  .3  .2   .1 .4  .7   1  .5  .4  .5  .3  0.5  .7 .4  .6  1   .9  92  .5 .5
39 .4/4  .6/4  .8/4  .5/4  .3/4  .3/4  .2/4   .1/4 .4/4  .7/4   1/4  .5/4  .4/4  .5/4  .3/4  0.5/4  .7/4 .4/4  .6/4  1/4   .9/4  .92/4  .5/4 .5/4
40 .4/4  .6/4  .8/4  .5/4  .3/4  .3/4  .2/4   .1/4 .4/4  .7/4   1/4  .5/4  .4/4  .5/4  .3/4  0.5/4  .7/4 .4/4  .6/4  1/4   .9/4  .92/4  .5/4 .5/4

44 .4/4  .7/4  .9/4  .6/4  .4/4  .35/4  .25/4   .15/4 .4/4  .73/4   .15/4  .52/4  .44/4  .52/4  .36/4  0.58/4  .78/4 .44/4  .61/4  1/4   1/4  .92/4  .5/4 .5/4
49 .4/4  .7/4  .9/4  .6/4  .4/4  .35/4  .25/4   .15/4 .4/4  .73/4   .15/4  .52/4  .44/4  .52/4  .36/4  0.58/4  .78/4 .44/4  .61/4  1/4   1/4  .92/4  .5/4 .5/4
];
%%hourly price bid of generator
hpb=[1 40.2 37.9 35.2 34.7 39.2 43.3 50.0 51.3 51.8 43.6 42.0 42.9 39.0 40.8 41.2 42.7 50.1 57.9 66.1 67.1 61.6 59.2 49.4 44.7
5 38.3 41.2 36.2 34.0 36.2 45.6 57.2 48.6 50.5 42.7 40.9 46.0 40.2 43.1 42.4 44.3 46.0 51.4 57.2 69.8 67.8 54.8 54.9 45.1
8 42.1 38.4 37.1 34.3 37.8 40.8 53.1 57.6 51.3 43.0 40.1 42.4 41.8 42.6 39.9 41.8 47.6 56.1 59.8 68.9 66.0 56.9 50.3 48.2
13 44.0 35.1 34.3 36.9 34.9 41.2 52.5 60.1 49.2 44.7 44.9 40.0 43.6 41.3 44.3 45.2 48.9 53.1 63.9 70.3 65.2 58.8 50.8 46.1
21 41.4 37.0 34.8 36.0 34.2 38.5 51.3 58.0 48.1 44.0 42.5 41.8 40.6 41.7 41.9 44.9 44.8 57.2 62.1 65.2 64.0 60.4 52.1 44.0
23 37.6 40.6 35.7 35.1 34.5 41.9 48.2 57.0 47.0 45.2 42.9 43.4 41.1 40.0 43.0 43.2 46.4 54.0 63.0 71.4 66.7 58.1 53.7 46.7
27 44.7 38.9 38.0 37.8 36.7 44.1 45.3 61.2 47.8 45.8 41.6 40.6 42.3 38.7 39.4 46.5 48.1 55.2 61.6 68.0 62.9 57.5 52.6 45.4
28 39.5 35.9 36.8 35.6 35.3 43.0 55.4 54.2 48.7 47.1 44.1 41.1 39.3 39.2 40.7 43.9 47.0 54.8 61.0 75.1 64.8 56.0 53.0 43.3
35 0     0    0    0    0    0    0    0    0     0   0    0    0    0     0    0   0     0    0    0    0    0    0   0
39 0     0    0    0    0    0    0    0    0     0   0    0    0    0     0    0   0     0    0    0    0    0    0   0
40 0     0    0    0    0    0    0    0    0     0   0    0    0    0     0    0   0     0    0    0    0    0    0   0
44 0     0    0    0    0    0    0    0    0     0   0    0    0    0     0    0   0     0    0    0    0    0    0   0
49 0     0    0    0    0    0    0    0    0     0   0    0    0    0     0    0   0     0    0    0    0    0    0   0
];
%%hourly energy bid of demand
hebd= [2 0.53 0.41 0.59 0.48 0.42 0.55 0.65 0.27 0.83 0.44 0.64 0.47 0.20 0.48 0.40 0.33 0.32 0.78 0.33 0.98 0.83 0.81 0.59 0.26
       3 0.42 0.46 0.42 0.25 0.26 0.47 0.48 0.75 0.31 0.25 0.25 0.18 0.29 0.19 0.65 0.59 0.26 0.36 0.92 0.88 0.57 0.77 0.31 0.64
       7 0.51 0.29 0.21 0.17 0.78 0.72 0.73 0.42 0.23 0.49 0.59 0.79 0.23 0.27 0.33 0.28 0.54 0.42 0.45 0.60 0.79 0.50 0.34 0.21
      10 0.65 0.40 0.29 0.56 0.54 0.54 0.51 0.53 0.56 0.34 0.31 0.32 0.29 0.26 0.56 0.34 0.45 0.29 0.58 0.83 0.82 0.39 0.47 0.48
      11 0.43 0.65 0.32 0.39 0.41 0.63 0.40 0.61 0.78 0.52 0.48 0.43 0.37 0.47 0.41 0.23 0.46 0.83 0.25 0.89 0.60 0.48 0.69 0.34
      12 0.24 0.24 0.47 0.28 0.62 0.43 0.59 0.89 0.62 0.49 0.18 0.57 0.41 0.55 0.19 0.49 0.57 0.63 0.82 0.71 0.27 0.91 0.74 0.56
      14 0.63 0.43 0.23 0.58 0.28 0.42 0.22 0.52 0.33 0.34 0.39 0.36 0.38 0.32 0.26 0.54 0.64 0.53 0.72 0.56 0.52 0.23 0.71 0.49
      16 0.35 0.28 0.51 0.34 0.52 0.64 0.88 0.92 0.44 0.38 0.73 0.54 0.58 0.50 0.63 0.48 0.31 0.11 0.82 0.40 0.59 0.57 0.41 0.26
      17 0.41 0.41 0.21 0.45 0.19 0.23 0.32 0.44 0.50 0.51 0.26 0.27 0.41 0.47 0.41 0.41 0.57 0.57 0.94 0.76 0.48 0.25 0.55 0.65
      18 0.54 0.48 0.47 0.56 0.21 0.26 0.28 0.72 0.82 0.32 0.42 0.64 0.61 0.16 0.25 0.53 0.43 0.64 0.97 0.49 0.41 0.38 0.72 0.71
      19 0.23 0.51 0.40 0.38 0.44 0.28 0.45 0.58 0.31 0.63 0.39 0.43 0.47 0.41 0.34 0.29 0.68 0.75 0.39 0.31 0.90 0.87 0.28 0.18
      20 0.38 0.37 0.53 0.43 0.22 0.40 0.34 0.61 0.74 0.71 0.22 0.12 0.62 0.34 0.47 0.67 0.51 0.68 0.35 1.10 0.59 0.35 0.30 0.65
      22 0.61 0.32 0.36 0.34 0.61 0.54 0.72 0.72 0.61 0.57 0.54 0.26 0.28 0.58 0.26 0.52 0.43 0.55 0.76 0.47 0.95 0.68 0.64 0.45
      26 0.12 0.67 0.59 0.27 0.59 0.63 0.43 0.65 0.44 0.39 0.42 0.35 0.48 0.16 0.54 0.66 0.54 0.86 0.31 0.64 0.57 0.94 0.53 0.72
     29 0.68 0.19 0.48 0.62 0.53 0.22 0.62 0.36 0.37 0.54 0.53 0.46 0.30 0.73 0.39 0.28 0.47 0.36 0.63 0.85 0.86 0.45 0.33 0.16
     30 0.47 0.61 0.32 0.14 0.26 0.40 0.86 0.29 0.43 0.28 0.53 0.37 0.48 0.35 0.63 0.56 0.50 0.28 0.68 0.57 0.65 0.86 0.87 0.44
     32 .4/3  .6/3  .8/3  .5/3  .3/3  .3/3  .2/3   .1/3 .4/3  .7/3   1/3  .5/3  .4/3  .5/3  .3/3  0.5/3  .7/3 .4/3  .6/3  1/3   .9/3  92/3  .5/3 .5/3
     33 .4/3  .6/3  .8/3  .5/3  .3/3  .3/3  .2/3   .1/3 .4/3  .7/3   1/3  .5/3  .4/3  .5/3  .3/3  0.5/3  .7/3 .4/3  .6/3  1/3   .9/3  92/3  .5/3 .5/3
     34 .4/3  .6/3  .8/3  .5/3  .3/3  .3/3  .2/3   .1/3 .4/3  .7/3   1/3  .5/3  .4/3  .5/3  .3/3  0.5/3  .7/3 .4/3  .6/3  1/3   .9/3  92/3  .5/3 .5/3
    36 .4/4  .6/4  .8/4  .5/4  .3/4  .3/4  .2/4   .1/4 .4/4  .7/4   1/4  .5/4  .4/4  .5/4  .3/4  0.5/4  .7/4 .4/4  .6/4  1/4   .9/4  92/4  .5/4 .5/4
    37 .4/4  .6/4  .8/4  .5/4  .3/4  .3/4  .2/4   .1/4 .4/4  .7/4   1/4  .5/4  .4/4  .5/4  .3/4  0.5/4  .7/4 .4/4  .6/4  1/4   .9/4  92/4  .5/4 .5/4  
    43 .04  .07  .09  .06  .04  .035  .025   .015 .04  .0730   .015  .052  .044  .052  .036  0.058  .078 .044  .061  .01   .1  .09  .05 .05 
    46 .04  .07  .09  .06  .04  .035  .025   .015 .04  .0730   .015  .052  .044  .052  .036  0.058  .078 .044  .061  .01   .1  .09  .05 .05 
    47 .04  .07  .09  .06  .04  .035  .025   .015 .04  .0730   .015  .052  .044  .052  .036  0.058  .078 .044  .061  .01   .1  .09  .05 .05 
    48 .04  .07  .09  .06  .04  .035  .025   .015 .04  .0730   .015  .052  .044  .052  .036  0.058  .078 .044  .061  .01   .1  .09  .05 .05 
    50 .04  .07  .09  .06  .04  .035  .025   .015 .04  .0730   .015  .052  .044  .052  .036  0.058  .078 .044  .061  .01   .1  .09  .05 .05 
    
    ];
%hourly price bid of demand
hbpd=[80*ones(1,24) 
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24) 
    80*ones(1,24)
    80*ones(1,24) 
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24)
    80*ones(1,24)
    43.5 41.6 33.7 36.1 35.5 43.9 48.2 58.0 41.0 46.2 41.9 43.8 43.9 45 44.0 42.5 48.4 58.4 63.0 72.4 65.7 59.1 52.7 48.7
    42.4 38.0 35.8 38.0 38.2 40.5 54.3 60.0 53.1 47.0 44.5 45.8 41.6 41.7 44.9 48.9 48.8 59.2 62.1 68.2 64.0 62.4 53.1 45.0
    80*ones(1,24)
     80*ones(1,24)
      80*ones(1,24)
       80*ones(1,24)
       80*ones(1,24)
       80*ones(1,24)
       80*ones(1,24)
      80*ones(1,24)
       80*ones(1,24)
       80*ones(1,24)
       80*ones(1,24)
       ];


hbpd=.9*hbpd;
%Link MAtrix
Link=Thematrix(:,2:4);
  
 %The number of nodes in the grid 
  Node_Number=50;
  
 %The number of transmission lines in the grid
  Link_Number=length(Link);
  
  
  %A vector to show the transmission line capacities
  C=6*ones(length(Thematrix),1);
 %The set of nodes that include a generator
 
  G=[1   4  5     8    13  16  21    23  24  27    28 30 35 39 40 44 49]';

 %The set of node that include a load
  D=hebd(:,1);
%The set of strategic generator 
%buses where strategic generators located (at buses 4, 16, 24, 30);
S=[4, 16, 24, 30]';
P_S_Max=[1 1 1 1]';
P_S_Min=zeros(length(S),1);

%preparing matrx
Scenario_Sets=[1:20];
P_G_Max=zeros(length(G)-length(S),length(Scenario_Sets),24);
P_D_Max=zeros(length(D),length(Scenario_Sets),24);
P_G_Min=zeros(length(G)-length(S),length(Scenario_Sets),24);
P_D_Min=zeros(length(D),length(Scenario_Sets),24);
a=zeros(length(G)-length(S),length(Scenario_Sets),24);
b=zeros(length(D),length(Scenario_Sets),24);
for Time=1:24

%The coefficient of generation cost for generators in S.
c=[11.46 11.96 13.89 15.97]';
%The maximum power of each generator, 2 shows the hour 1, 3 shows hour 3
%,...

P_G_Max1=heb(:,Time+1);
%non-strategic supply price bid(They are constant at each time slot)2 shows the hour 1, 3 shows hour 3
a1=hpb(:,Time+1);
%demand energy bids,2 shows the hour 1, 3 shows hour 3
P_D_Max1=hebd(:,Time+1);
%Demand price bid at each hour for each consumer
b1=hbpd(:,Time);
%8 Scenario_Sets are considered. b and a are multiplied by sce and other
%parameters are constant
%Scenario_Sets are generated by multplying the offer/bid curves by the vector:
sc=[2 1.9 1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1 1 .9 .8 .7 .6 .5 .4 .3 .2 .1];

%

b1=b1(:,ones(1,length(Scenario_Sets))).*sc(ones(1,size(b,1)),1:length(Scenario_Sets));
a1=a1(:,ones(1,length(Scenario_Sets))).*sc(ones(1,size(a,1)),1:length(Scenario_Sets));
P_G_Max1=P_G_Max1(:,ones(1,length(Scenario_Sets)));
P_D_Max1=P_D_Max1(:,ones(1,length(Scenario_Sets)));

%%

P_G_Max(:,:,Time)=P_G_Max1;
P_D_Max(:,:,Time)=P_D_Max1;
a(:,:,Time)=a1;
b(:,:,Time)=b1;
end


      Gamma=1*ones(length(S),1);

      
      
      Link(:,3)=1./Link(:,3);



